package runner;

import java.io.IOException;

import org.openqa.selenium.*;
import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;

import utils.*;


class Testrunner extends Base
{ Reporter report = new Reporter();
    ExtentReports reports = report.generateExtentReport("report");
    ExtentTest test = null;
    @BeforeMethod
    void lauch()
    {
        openBrowser();
    }
    @Test
    void test()
    {
      test = reports.createTest("click on Blog");
      LoggerHandler.info("click on signin");
      test.pass("click");
      for(int i=0;i<300;i++)
      {
        LoggerHandler.info("click on signin");
        test.pass("click");
      }
      Screenshot.captureScreenShot("agronetto_screenshot");
      test.addScreenCaptureFromPath("/home/coder/project/workspace/Project/screenshots/agronetto_screenshot2025.08.25.03.53.54.png");
      WebDriverHelper helper = new WebDriverHelper(driver);
      helper.clickOnElement(By.xpath("//button[@aria-label=\"Where to?\"]"));
      try {
        String searchterm = ExcelReader.readdata("/home/coder/project/workspace/Project/src/test/java/testdata/data.xlsx", "Sheet1", 0, 0);
        helper.sendKeys(By.xpath("//input[@data-stid=\"destination_form_field-menu-input\"]"), searchterm);
      } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
      }
      helper.enterAction(By.xpath("//input[@data-stid=\"destination_form_field-menu-input\"]"));
      
      
      
    }
    @AfterMethod
    void teardown()
    {
        driver.quit();
    }
    @AfterClass
    void report()
    {
        reports.flush();
    }
}
